# op-proposer 和 op-batcher 的区别

## 1. 功能定位不同:

- **op-proposer**:
  - 主要负责向 L1 提交 L2 状态的输出根(output-root)提案
  - 每个提案交易都会向 L1 提交一个 L2 状态的声明
  - 提案间隔较长，通常为 1 小时
  - 主要用于确保 L2 状态的可验证性

- **op-batcher**:
  - 主要负责确保数据可用性(Data Availability)
  - 将 L2 的交易数据批量打包并提交到 L1
  - 提交频率更高，需要持续不断地将 L2 交易数据提交到 L1
  - 主要用于确保 L2 交易数据的可用性

## 2. 工作流程不同:

- **op-proposer**:
  - 查询 L2 的输出根
  - 向 L1 提交状态声明
  - 等待声明被解决
  - 用于提款验证

- **op-batcher**:
  - 从 sequencer 读取不安全区块
  - 将区块数据打包成批次
  - 将批次提交到数据可用性层(如 L1)
  - 处理数据压缩和通道管理

## 3. 优化目标不同:

- **op-proposer**:
  - 优化重点是简单性和安全性
  - 提案执行速度不是主要优化目标
  - 更注重提案的正确性

- **op-batcher**:
  - 优化重点是数据可用性和吞吐量
  - 需要处理数据压缩和通道管理
  - 更注重数据提交的效率

## 4. 故障处理不同:

- **op-proposer**:
  - 主要关注 L1 RPC 故障和本地临时故障
  - 通过 L1 RPC 冗余和警报来缓解故障

- **op-batcher**:
  - 需要处理数据可用性积压问题
  - 有更复杂的故障恢复机制
  - 可以动态调整数据提交策略

## 5. 配置参数不同:

- **op-proposer**:
  - 主要配置提案间隔、L1/L2 RPC 等
  - 配置相对简单

- **op-batcher**:
  - 需要配置批次大小、通道持续时间、压缩算法等
  - 配置更复杂，涉及更多参数

总的来说，op-proposer 和 op-batcher 是 Optimism 系统中两个不同但互补的组件，分别负责状态验证和数据可用性，共同确保系统的安全性和可用性。 